(this["webpackJsonptribute-ui"]=this["webpackJsonptribute-ui"]||[]).push([[8],{988:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));var r=n(8),o=n(3),s=n(1),a=n(142),c=n(41),i=n(48),d=n(9),u=n(7),l=n(62),b=n(38),j=n(17),p=n(32),f=n(2),O=n.n(f),h=n(5),x=n(14),g=n(20),m=n(34),w=n(60),v=n(16),N=n(72),P=n(51),I=n(25),S=n(43),E=n(0),F={skipIsActiveMemberCheck:!0};function V(e){var t=e.disabled,n=e.proposal.snapshotProposal,r=Object(s.useState)(),a=Object(o.a)(r,2),c=a[0],i=a[1],d=Object(x.c)((function(e){return e.contracts})),j=Object(x.c)((function(e){return e.contracts.DaoRegistryContract})),f=Object(v.e)(),V=f.account,k=f.web3Instance,M=Object(v.a)(),A=M.txEtherscanURL,D=M.txIsPromptOpen,R=M.txSend,y=M.txStatus,C=Object(b.g)(F),G=C.isDisabled,L=C.openWhyDisabledModal,_=C.WhyDisabledModal,T=Object(x.b)(),W=y===u.f.AWAITING_CONFIRM||y===u.f.PENDING,U=y===u.f.FULFILLED,J=W||U||D,Y=G||J||t;function q(){return(q=Object(h.a)(O.a.mark((function e(){var t,r,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,j){e.next=3;break}throw new Error("No DAO Registry contract was found.");case 3:if(n){e.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:if(V){e.next=7;break}throw new Error("No account found.");case 7:if(k){e.next=9;break}throw new Error("No Web3 instance was found.");case 9:return t=Object(m.e)(n.actionId,d),r=[j.contractAddress,n.idInDAO],o={from:V||""},e.next=14,R("processProposal",t.instance.methods,r,o);case 14:if(!e.sent){e.next=18;break}return e.next=18,T(Object(g.A)({account:V,daoRegistryContract:j,web3Instance:k}));case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),i(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)("div",{children:[Object(E.jsx)("button",{className:"proposaldetails__button",disabled:Y,onClick:Y?function(){}:function(){return q.apply(this,arguments)},children:W?Object(E.jsx)(S.a,{}):U?"Done":"Process"}),Object(E.jsx)(p.a,{error:c,renderText:"Something went wrong"}),J&&Object(E.jsx)("div",{className:"form__submit-status-container",children:function(){switch(y){case u.f.AWAITING_CONFIRM:return Object(E.jsxs)(E.Fragment,{children:["Awaiting your confirmation",Object(E.jsx)(l.a,{})]});case u.f.PENDING:return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(N.a,{intervalMs:2e3,messages:w.b,useFirstItemStart:!0,render:function(e){return Object(E.jsx)(I.a,{children:e},e)}}),Object(E.jsx)(P.a,{url:A,isPending:!0})]});case u.f.FULFILLED:return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("div",{children:"Proposal submitted!"}),Object(E.jsx)(P.a,{url:A})]});default:return null}}()}),G&&Object(E.jsx)("button",{className:"button--help-centered",onClick:L,children:"Why is processing disabled?"})]}),Object(E.jsx)(_,{title:"Why is processing disabled?"})]})}var k=n(214),M=c.c.Completed,A=c.c.OffchainVotingGracePeriod,D=c.c.OffchainVotingSubmitResult,R=c.c.OffchainVoting,y=c.c.Process,C=c.c.Submit,G=d.a.FULFILLED,L=[u.b.offchainVotingVotingPeriod,u.b.offchainVotingGracePeriod];function _(e){var t,n=e.adapterName,c=e.proposal,d=e.renderAction,u=Object(b.d)(L),f=Object(o.a)(u.daoConfigurations,2),O=f[0],h=f[1],x=Object(i.e)(Object(s.useMemo)((function(){return{proposal:c}}),[c])),g=x.daoProposalVoteResult,m=x.daoProposalVote,w=x.proposalFlowStatusError,v=x.status,N=x.stopPollingForStatus,P=Object(i.c)(c.snapshotProposal),I=P.offchainVotingResults,S=P.offchainVotingResultsStatus,F=1e3*Number((null===m||void 0===m?void 0:m.gracePeriodStartingTime)||0),_=F+1e3*Number(h||0),T=1e3*Number((null===m||void 0===m?void 0:m.startingTime)||0),W=T+1e3*Number(O||0),U=null===(t=I[0])||void 0===t?void 0:t[1],J=(null===U||void 0===U?void 0:U.Yes.units)||0,Y=(null===U||void 0===U?void 0:U.No.units)||0,q=d&&d(Object(r.a)({},j.c.OffchainVotingContract,{adapterName:n,daoProposalVote:m,daoProposalVoteResult:g,gracePeriodEndMs:_,gracePeriodStartMs:F,proposal:c,status:v}));return Object(s.useEffect)((function(){v===D&&S===G&&J<=Y&&N()}),[Y,S,v,N,J]),Object(E.jsxs)(E.Fragment,{children:[(v===R||v===D||v===A||v===y||v===M)&&Object(E.jsx)(a.c,{countdownGracePeriodEndMs:_,countdownGracePeriodStartMs:F,countdownVotingEndMs:W,countdownVotingStartMs:T,renderStatus:function(e){if(e.hasGracePeriodEnded&&v===A)return Object(E.jsxs)("span",{children:["Grace period ended ",Object(E.jsx)("br",{})," ",Object(E.jsxs)("span",{style:{textTransform:"lowercase"},children:["Awaiting contract status",Object(E.jsx)(l.a,{})]})]})},votingResult:U}),Object(E.jsx)("div",{className:"proposaldetails__button-container",children:q||(v===C?Object(E.jsx)(k.a,{proposal:c}):v===R?Object(E.jsx)(a.b,{adapterName:n,proposal:c}):v===D?S!==G||J<=Y?null:Object(E.jsx)(a.a,{adapterName:n,proposal:c}):v===y||v===A?Object(E.jsx)(V,{disabled:v===A,proposal:c}):void 0)}),Object(E.jsx)(p.a,{error:w,renderText:"Something went wrong while getting the proposal's status"})]})}}}]);
//# sourceMappingURL=8.a2f76eff.chunk.js.map