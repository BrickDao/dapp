(this["webpackJsonptribute-ui"]=this["webpackJsonptribute-ui"]||[]).push([[8],{989:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return T}));var r=n(8),o=n(4),s=n(1),a=n(142),c=n(41),i=n(48),u=n(9),d=n(7),l=n(62),b=n(38),j=n(17),p=n(32),f=n(2),O=n.n(f),h=n(3),x=n(5),g=n(15),m=n(20),w=n(34),v=n(60),P=n(14),N=n(72),I=n(51),E=n(25),S=n(43),F=n(0),V={skipIsActiveMemberCheck:!0};function k(e){var t=e.disabled,n=e.proposal.snapshotProposal,r=Object(s.useState)(),a=Object(o.a)(r,2),c=a[0],i=a[1],u=Object(g.c)((function(e){return e.contracts})),j=Object(g.c)((function(e){return e.contracts.DaoRegistryContract})),f=Object(P.f)(),k=f.account,M=f.web3Instance,R=Object(P.a)(),A=R.txEtherscanURL,D=R.txIsPromptOpen,y=R.txSend,C=R.txStatus,G=Object(P.b)({noRunIfEIP1559:!0}).average,L=Object(b.g)(V),_=L.isDisabled,T=L.openWhyDisabledModal,W=L.WhyDisabledModal,U=Object(g.b)(),J=C===d.f.AWAITING_CONFIRM||C===d.f.PENDING,Y=C===d.f.FULFILLED,q=J||Y||D,z=_||q||t;function B(){return(B=Object(x.a)(O.a.mark((function e(){var t,r,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,j){e.next=3;break}throw new Error("No DAO Registry contract was found.");case 3:if(n){e.next=5;break}throw new Error("No Snapshot proposal was found.");case 5:if(k){e.next=7;break}throw new Error("No account found.");case 7:if(M){e.next=9;break}throw new Error("No Web3 instance was found.");case 9:return t=Object(w.e)(n.actionId,u),r=[j.contractAddress,n.idInDAO],o=Object(h.a)({from:k||""},G?{gasPrice:G}:null),e.next=14,y("processProposal",t.instance.methods,r,o);case 14:if(!e.sent){e.next=18;break}return e.next=18,U(Object(m.A)({account:k,daoRegistryContract:j,web3Instance:M}));case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),i(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)("div",{children:[Object(F.jsx)("button",{className:"proposaldetails__button",disabled:z,onClick:z?function(){}:function(){return B.apply(this,arguments)},children:J?Object(F.jsx)(S.a,{}):Y?"Done":"Process"}),Object(F.jsx)(p.a,{error:c,renderText:"Something went wrong"}),q&&Object(F.jsx)("div",{className:"form__submit-status-container",children:function(){switch(C){case d.f.AWAITING_CONFIRM:return Object(F.jsxs)(F.Fragment,{children:["Awaiting your confirmation",Object(F.jsx)(l.a,{})]});case d.f.PENDING:return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(N.a,{intervalMs:2e3,messages:v.b,useFirstItemStart:!0,render:function(e){return Object(F.jsx)(E.a,{children:e},e)}}),Object(F.jsx)(I.a,{url:A,isPending:!0})]});case d.f.FULFILLED:return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("div",{children:"Proposal submitted!"}),Object(F.jsx)(I.a,{url:A})]});default:return null}}()}),_&&Object(F.jsx)("button",{className:"button--help-centered",onClick:T,children:"Why is processing disabled?"})]}),Object(F.jsx)(W,{title:"Why is processing disabled?"})]})}var M=n(214),R=c.c.Completed,A=c.c.OffchainVotingGracePeriod,D=c.c.OffchainVotingSubmitResult,y=c.c.OffchainVoting,C=c.c.Process,G=c.c.Submit,L=u.a.FULFILLED,_=[d.b.offchainVotingVotingPeriod,d.b.offchainVotingGracePeriod];function T(e){var t,n=e.adapterName,c=e.proposal,u=e.renderAction,d=Object(b.d)(_),f=Object(o.a)(d.daoConfigurations,2),O=f[0],h=f[1],x=Object(i.e)(Object(s.useMemo)((function(){return{proposal:c}}),[c])),g=x.daoProposalVoteResult,m=x.daoProposalVote,w=x.proposalFlowStatusError,v=x.status,P=x.stopPollingForStatus,N=Object(i.c)(c.snapshotProposal),I=N.offchainVotingResults,E=N.offchainVotingResultsStatus,S=1e3*Number((null===m||void 0===m?void 0:m.gracePeriodStartingTime)||0),V=S+1e3*Number(h||0),T=1e3*Number((null===m||void 0===m?void 0:m.startingTime)||0),W=T+1e3*Number(O||0),U=null===(t=I[0])||void 0===t?void 0:t[1],J=(null===U||void 0===U?void 0:U.Yes.units)||0,Y=(null===U||void 0===U?void 0:U.No.units)||0,q=u&&u(Object(r.a)({},j.c.OffchainVotingContract,{adapterName:n,daoProposalVote:m,daoProposalVoteResult:g,gracePeriodEndMs:V,gracePeriodStartMs:S,proposal:c,status:v}));return Object(s.useEffect)((function(){v===D&&E===L&&J<=Y&&P()}),[Y,E,v,P,J]),Object(F.jsxs)(F.Fragment,{children:[(v===y||v===D||v===A||v===C||v===R)&&Object(F.jsx)(a.c,{countdownGracePeriodEndMs:V,countdownGracePeriodStartMs:S,countdownVotingEndMs:W,countdownVotingStartMs:T,renderStatus:function(e){if(e.hasGracePeriodEnded&&v===A)return Object(F.jsxs)("span",{children:["Grace period ended ",Object(F.jsx)("br",{})," ",Object(F.jsxs)("span",{style:{textTransform:"lowercase"},children:["Awaiting contract status",Object(F.jsx)(l.a,{})]})]})},votingResult:U}),Object(F.jsx)("div",{className:"proposaldetails__button-container",children:q||(v===G?Object(F.jsx)(M.a,{proposal:c}):v===y?Object(F.jsx)(a.b,{adapterName:n,proposal:c}):v===D?E!==L||J<=Y?null:Object(F.jsx)(a.a,{adapterName:n,proposal:c}):v===C||v===A?Object(F.jsx)(k,{disabled:v===A,proposal:c}):void 0)}),Object(F.jsx)(p.a,{error:w,renderText:"Something went wrong while getting the proposal's status"})]})}}}]);
//# sourceMappingURL=8.9a3a0ec6.chunk.js.map